import random

def create_random_text_file(filename):
    """
    Створює текстовий файл з 101 рядком, кожен з яких містить 105 випадкових символів.
    Використовує українські літери та пробіли для імітації слів.
    """
    letters = 'абвгґдеєжзиіїйклмнопрстуфхцчшщьюя'  # Створюємо рядок з усіма українськими літерами
    population = letters + ' ' * 6  # Додаємо 6 пробілів до літер для частішого утворення "слів" (всього 39 символів)

    with open(filename, 'w', encoding='utf-8') as f:
        for _ in range(101):  # Цикл 101 разів для створення 101 рядка
            line = ''.join(random.choice(population) for _ in range(105))  # Генеруємо рядок: 105 випадкових символів
            f.write(line + '\n')  # Записуємо рядок у файл з символом нового рядка

    print(f"[INFO] Файл '{filename}' успішно створено.")  # Виводимо повідомлення про успішне створення файлу

def pair_counter_generator(filename):  # Визначаємо генератор для підрахунку пар букв у словах
    """
    Генератор читає файл по рядках, для кожного рядка вибирає 3 випадкові пари букв
    та рахує їх кількість тільки всередині окремих слів (ігнорує стики слів).
    """
    all_pairs = ['ан', 'ун', 'ну', 'не', 'на', 'за', 'по', 'ми']  # Список з 8 типових українських пар букв для пошуку

    with open(filename, 'r', encoding='utf-8') as f:
        line_num = 1  # Ініціалізуємо лічильник номерів рядків з 1
        for line in f:
            words = line.split()  # Розбиваємо рядок на слова за пробілами
            target_pairs = random.sample(all_pairs, 3)  # Вибираємо 3 унікальні випадкові пари

            results = {}
            for pair in target_pairs:  # Для кожної з 3 обраних пар виконуємо підрахунок
                count = 0
                for word in words:  # Перевіряємо кожне слово в рядку
                    count += word.count(pair)  # Додаємо кількість входжень пари в поточному слові (тільки всередині слова)
                results[pair] = count  # Зберігаємо результат для цієї пари в словнику

            yield f"Рядок {line_num}: шукали {target_pairs} -> знайшли {results}"  # Повертаємо форматований рядок з результатами (генератор продовжує роботу)

            line_num += 1  # Збільшуємо номер рядка для наступної ітерації

if __name__ == '__main__':
    file_name = 'lab9_text.txt'

    create_random_text_file(file_name)  # Викликаємо функцію створення тестового файлу

    print("Результати роботи генератора:")

    my_gen = pair_counter_generator(file_name)  # Створюємо об'єкт генератора для підрахунку пар

    for i in range(10):  # Цикл для виведення перших 10 результатів
        try:
            print(next(my_gen))  # Виводимо результат чергової ітерації генератора
        except StopIteration:  # Якщо генератор вичерпано (менше 10 рядків)
            break